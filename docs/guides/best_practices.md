# ベストプラクティス

marimoノートブックを記述するためのベストプラクティスをいくつか紹介します。

**グローバル変数を控えめに使用する。** プログラム内のグローバル変数の数を少なくして、名前の衝突を避けます。中間変数がある場合は、関数にカプセル化するか、アンダースコア（`_tmp = ...`）を付けてセルにローカルにします。

**説明的な名前を使用する。** 特にグローバル変数には説明的な変数名を使用します。これにより名前の衝突を最小限に抑え、より良いコードにもなります。

**関数を使用する。** ロジックを関数にカプセル化して、一時的または中間変数でグローバル名前空間を汚染することを避け、コードの重複を避けます。

**[`mo.stop`][marimo.stop]を使用して実行を停止する。** 条件が真の場合にセルの実行を停止するには[`mo.stop`][marimo.stop]を使用します。これは高コストなノートブックで作業する際に役立ちます。例えば、[`mo.ui.run_button`][marimo.ui.run_button]と[`mo.stop`][marimo.stop]を使用して、ボタンがクリックされるまでセルの実行を防ぎます。

!!! caution "高コストなノートブック"
    高コストなノートブックでの作業の追加のヒントについては、関連する[ガイド](../guides/expensive_notebooks.md)をご覧ください。

**Pythonモジュールを使用する。** ノートブックが長すぎる場合は、複雑なロジックをヘルパーPythonモジュールに分割し、ノートブックにインポートします。marimoの組み込み[モジュール自動再読み込み](../guides/configuration/runtime_configuration.md#on-module-change)を使用して、モジュールからの変更を自動的にノートブックに取り込みます。

**変更を最小限に抑える。** marimoはオブジェクトへの変更を追跡しません。オブジェクトを作成するセルでのみ変更するか、既存のオブジェクトを変更する代わりに新しいオブジェクトを作成するようにしてください。

??? example "例"

    _複数のセルにわたって宣言と変更を分割しないでください。例えば、_これをしないでください：_

    ```python
    l = [1, 2, 3]
    ```

    ```python
    l.append(new_item())
    ```

    代わりに、_同じセルで宣言して変更します_：

    ```python
    l = [1, 2, 3]
    ...
    l.append(new_item())
    ```

    または、複数のセルで作業する場合、**古い変数に基づいて新しい変数を宣言します**：

    ```python
    l = [1, 2, 3]
    ```

    ```python
    extended_list = l + [new_item()]
    ```

**stateと`on_change`ハンドラーを使用しない。** UI操作に反応するために`on_change`ハンドラーを使用しないでください。代わりに、marimoの組み込み[インタラクティブ要素のリアクティブ実行](../guides/interactivity.md)を使用します。

**べき等セルを記述する。**
同じ入力（参照）が与えられた場合に出力と動作が同じセルを記述します。このようなセルはべき等と呼ばれます。これにより、バグを避け、高コストな中間計算をキャッシュできます。

